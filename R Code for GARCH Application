# Short Application of the GARCH Model to Foreign Exchange Data â€“ USD and EUR

# Download monthly data from 1999 to 2024 (EXUSEU) from the FRED database. This represents the spot exchange rate between the US Dollar and Euro.

####Dollar per Euro####

df = read.csv("Documents/EXUSEU.csv") # identify your path to obtain document. Name it df.
tail(df)
install.packages("rugarch")
library(rugarch)

E = ts(df[,2], end = c(2024,09), frequency = 12)
e = diff(log(E))
plot(e, ylab = "", xlab ="") # we see tremendous volatility during the financial recession, but not as much during the Pandemic.
abline(h=0, col = "red", lty = 2, lwd = 4)

acf(e) # the blue lines indicate the confidence interval(s) 
pacf(e) # we see that there is only one spike, suggesting that the values depend primarily upon its preceding value. This then indicates that we should use an AR(1) process.

ar1 = arima(e,c(1,0,0))
ar1 # the AR1 is indeed significant. We can test an AR(2) model as well

ar2 = arima(e,c(2,0,0))
ar2 # the AR2 variable is NOT significant

arma11 = arima(e,c(1,0,1))
arma11 # the moving average component is NOT significant. It is best to stay with AR(1). 

g1 = ugarchspec(variance.model=list(model="sGARCH", garchOrder = c(1,1)), mean.model=list(armaOrder=c(1,0),
distribution.model="std"))

garch_1_1 = ugarchfit(g1, data = e)
garch_1_1 # variety of variables are indeed statistically significant. Thus, let us trust the model...

# create a variance series

volatilitye = ts(garch_1_1@fit$sigma^2,end=c(2024,09),frequency = 12)
plot(volatilitye, xlab="", ylab="", main = "Volatility of EUR/USD with GARCH(1,1)")

# We can also try an exponentiial GARCH Model:

egarch =  ugarchspec(variance.model=list(model="eGARCH", garchOrder = c(1,1)), mean.model=list(armaOrder=c(1,0),
distribution.model="std"))
egarch_1_1 = ugarchfit(egarch, data = e)
egarch_1_1
coef(egarch_1_1)

volatilitye2 <- ts(egarch_1_1@fit$sigma^2,end=c(2019,10),frequency = 12)
plot(volatilitye2,xlab="",ylab="",main="JPYUSD Volatility (EGARCH[1,1])")

cor(volatilitye, volatilitye2)

ts.plot(volatilitye,volatilitye2,col=c("black","red"),xlab="")
legend("topright",legend=c("Standard GARCH","Exponential GARCH"),col=c("black","red"),lty=c(1,1))

## input this at the end of the code:

lag.length = 30

# Null Hypothesis: Residuals are independently distributed
# Alternative Hypothesis: Residuals are not independently distributed (serial correlation)

Box.test(e, lag = lag.length, type = "Ljung-Box") # test for stationarity. p-value is extremely small. Reject the null hypothesis = Serial correlation

install.packages("zoo")
library(zoo)
install.packages("strucchange")
library(strucchange)
install.packages("tseries")
library(tseries)

length(e)
time = c(1:308)
BP = breakpoints(e ~ time, h = 46) # rule of thumb --> 15% of the number of observations
BP 3 # structural break occurred December 1st, 2003 --> So there being a structural break may explain why the Box-Ljung Test is inconsistent with stationarity...

coef(BP)

BP_2 = efp(e ~ breakfactor(BP), type = "OLS-CUSUM")
plot(BP_2) # BUT, this demonstrates that the structural break does not exceed the bands in question... Thus, the structural break is not statistically significant...